{% extends 'base.html.twig' %}

{% block title %}Annonce
{% endblock %}

{% block body %}
	<div class="container-xxl bg-white p-0">
		<div class="container-xxl py-5">
			<div class="container">
				<nav aria-label="breadcrumb" class="animated fadeIn">
					<ol class="breadcrumb text-uppercase">
						<li class="breadcrumb-item">
							<a href="#">Home</a>
						</li>
						<li class="breadcrumb-item">
							<a href="{{path('app_profil')}}">Profil</a>
						</li>
						<li class="breadcrumb-item text-body active" aria-current="page">Annonce</li>
					</ol>
				</nav>

				<div class="bg-light rounded p-3">
					<div class="bg-white rounded p-4" style="border: 1px dashed rgba(0, 185, 142, .3)">
						<div class="row g-5 align-items-center">
							<div class="col-lg-4 position-relative overflow-hidden">
								<div class="bg-primary rounded text-white position-absolute start-0 top-0 m-4 py-1 px-3">
									{% if annonce.etat == 1 %}
										Disponible
									{% elseif annonce.etat == 2 %}
										Non disponible
									{% elseif annonce.etat == 3 %}
										En attente
									{% else %}
										Statut inconnu
									{% endif %}
								</div>
								{% for image in annonce.images %}
									<img src="{{ asset('uploads/images/' ~ image.image) }}" alt="{{ image.alt }}" class="img-fluid mb-4">
								{% endfor %}
								<div class="bg-white rounded-top text-primary position-absolute start-0 bottom-0 mx-4 pt-1 px-3">{{ annonce.categorie }}</div>
							</div>

							<div class="col-lg-8">
								<div class="annonce-details">
									<h1 class="mb-4">{{ annonce.nom }}</h1>
									<p class="mb-4">{{ annonce.description }}</p>

									<div class="address-details mb-4">
										{% set adresse = annonce.adresse %}
										<div class="mb-3">
											<h2>Adresse :</h2>
											<ul class="list-unstyled">
												<li>
													<strong>Rue :</strong>
													{{ adresse.rue }}</li>
												<li>
													<strong>Ville, Pays :</strong>
													{{ adresse.ville }},
													{{ adresse.pays }}</li>
												<li>
													<strong>Code postal :</strong>
													{{ adresse.codepostal }}</li>
												{% if adresse.complement %}
													<li>
														<strong>Complément d'adresse :</strong>
														{{ adresse.complement }}</li>
												{% endif %}
											</ul>
										</div>
									</div>


									<div class="d-flex">
										<a href="{{ path('app_annonce_edit', {'id': annonce.id}) }}" class="btn btn-primary py-3 px-4 me-2" title="Modifier l'annonce">
											<i class="fa fa-cog"></i>
											Modifier
										</a>
										<button type="button" class="btn btn-danger py-3 px-4 me-2" data-toggle="modal" data-target="#deleteModal">
											Supprimer
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>


		<!-- equipements de l'annonce  -->

		<!-- avis -->
		<div class="container-xxl py-5">
			<div class="container">
				<div class="text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 600px;">
					<h5 class="mb-3">les avis de cette annonnces</h5>
				</div>
				<div class="owl-carousel testimonial-carousel wow fadeInUp" data-wow-delay="0.1s">
					{% for avis in annonce.avis %}
						<div class="testimonial-item bg-light rounded p-3">
							<div class="bg-white border rounded p-4">
								<p>{{ avis.commentaire }}</p>
								<h5 class="card-title">
									{% for i in range(1, 5) %}
										{% if i <= avis.note %}
											<i class="fas fa-star text-warning"></i>
										{% else %}
											<i class="far fa-star text-warning"></i>
										{% endif %}
									{% endfor %}
								</h5>
								<div class="d-flex align-items-center">
									{% set user = avis.user %}
									<img class="img-fluid flex-shrink-0 rounded" src="{{ asset('/uploads/Profilephoto/' ~ user.photo) }}" style="width: 45px; height: 45px;">
									<div class="ps-3">
										<h6 class="fw-bold mb-1">{{ user.nom }}
											{{ user.prenom }}</h6>
										<small>Publié le :
											{{ avis.date|date('Y-m-d H:i:s') }}</small>
									</div>
								</div>
							</div>
						</div>
					{% endfor %}

				</div>
			</div>
		</div>
		<!-- avis -->

		<!-- Modal -->
		<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						Are you sure you want to delete this annonce?
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						{{ include('annonce/_delete_form.html.twig') }}
					</div>
				</div>
			</div>
		</div>
	{% endblock %}
